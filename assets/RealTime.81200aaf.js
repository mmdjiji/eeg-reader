import{_ as F,I as d,J as f,K as i,L as h,M as w,U as p,V as a,W as v,O as y,P as E,Q as g,R as k,T as S}from"./index.6fb6d146.js";const b=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],l=(()=>{if(typeof document>"u")return!1;const e=b[0],t={};for(const n of b)if((n==null?void 0:n[1])in document){for(const[s,c]of n.entries())t[e[s]]=c;return t}return!1})(),x={change:l.fullscreenchange,error:l.fullscreenerror};let r={request(e=document.documentElement,t){return new Promise((n,o)=>{const s=()=>{r.off("change",s),n()};r.on("change",s);const c=e[l.requestFullscreen](t);c instanceof Promise&&c.then(s).catch(o)})},exit(){return new Promise((e,t)=>{if(!r.isFullscreen){e();return}const n=()=>{r.off("change",n),e()};r.on("change",n);const o=document[l.exitFullscreen]();o instanceof Promise&&o.then(n).catch(t)})},toggle(e,t){return r.isFullscreen?r.exit():r.request(e,t)},onchange(e){r.on("change",e)},onerror(e){r.on("error",e)},on(e,t){const n=x[e];n&&document.addEventListener(n,t,!1)},off(e,t){const n=x[e];n&&document.removeEventListener(n,t,!1)},raw:l};Object.defineProperties(r,{isFullscreen:{get:()=>Boolean(document[l.fullscreenElement])},element:{enumerable:!0,get:()=>{var e;return(e=document[l.fullscreenElement])!=null?e:void 0}},isEnabled:{enumerable:!0,get:()=>Boolean(document[l.fullscreenEnabled])}});l||(r={isEnabled:!1});const m=r;const L={data(){return{port:{},recvBuffer:[],stage:0,guide:!0,show:!1,ctx:["\u3000","\u3000","\u3000","\u3000","\u3000","\u3000","\u3000"]}},methods:{str2ascii(e){const t=[];for(const n in e)t.push(e.codePointAt(n));return t},recv2str(e){const t=[];for(const n of e)t.push(String.fromCodePoint(n));return t.join("")},async sendString(e){if(this.port.writable){const t=this.port.writable.getWriter(),n=new Uint8Array(this.str2ascii(e));await t.write(n),console.log(e,n),await t.releaseLock()}},async sleep(e){return new Promise(t=>setTimeout(t,e))},async setLine(e,t){this.ctx[e]=t},async clearLine(e){this.ctx[e]="\u3000"},async waitKey(e){const t=Date.now();return new Promise((n,o)=>{const s=c=>{if(e===c.code){window.removeEventListener("keydown",s,!0);const u=Date.now();n(u-t)}};window.addEventListener("keydown",s,!0)})},async execute(){await this.sleep(1e3),await this.setLine(3,"\u8BF7\u6CE8\u89C6\u4E2D\u5FC3"),await this.sleep(3e3),await this.setLine(3,"+"),await this.sleep(3e3),await this.setLine(3,"\u597D\u7684\uFF0C\u73B0\u5728\u6D4B\u8BD5\u4E00\u4E0B\u6309\u7A7A\u683C");const e=await this.waitKey("Space");await this.setLine(3,`\u4F60\u6309\u4E0B\u4E86\u7A7A\u683C\uFF0C\u7528\u65F6${e}\u6BEB\u79D2`);const t=await this.waitKey("Space");await this.setLine(3,`\u4F60\u53C8\u6309\u4E0B\u4E86\u4E00\u6B21\u7A7A\u683C\uFF0C\u7528\u65F6${t}\u6BEB\u79D2`);const n=await this.waitKey("Space");await this.setLine(3,`\u4F60\u53C8\u53C8\u53C8\u6309\u4E0B\u4E86N\u6B21\u7A7A\u683C\uFF0C\u7528\u65F6${n}\u6BEB\u79D2`),await this.sleep(3e3),await this.setLine(3,"\u5B9E\u9A8C\u7ED3\u675F\uFF0C\u597D\u8036")},async connect(){if(this.stage===0){this.stage=1,console.log("\u8FDE\u63A5\u8BBE\u5907");try{for(this.port=await navigator.serial.requestPort(),await this.port.open({baudRate:115200}),await this.sendString(`AT+ROLE=0\r
`);this.port.readable;){const e=this.port.readable.getReader();try{for(;;){const{value:t,done:n}=await e.read();if(n){e.releaseLock();break}if(t){for(const o of t)if(this.recvBuffer.push(o),this.recvBuffer[this.recvBuffer.length-2]===13&&this.recvBuffer[this.recvBuffer.length-1]===10){const s=this.recv2str(this.recvBuffer);this.recvBuffer=[],console.log(s),s===`+IM_MASTER\r
`&&(this.stage=2)}this.stage===2&&(await this.sendString(`AT+SCAN=1,5\r
`),this.stage=3)}}}catch(t){console.error(t)}}}catch(e){console.error(e)}}},async start(){this.guide=!1,this.show=!0,document.body.setAttribute("style","background: #000000; cursor: none;"),m.isEnabled&&!m.isFullscreen?m.toggle():alert("\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u5168\u5C4F\uFF0C\u8BF7\u6309 F11 \u624B\u52A8\u8C03\u6574\u5168\u5C4F"),await this.execute()}},mounted(){}},B=e=>(k("data-v-8187efa8"),e=e(),S(),e),P={key:0,id:"guide",style:{margin:"0 auto"}},C={style:{"text-align":"center"}},R=B(()=>i("h1",null,"\u5B9E\u65F6\u91C7\u96C6",-1)),M={style:{"text-align":"center"}},T={key:1,id:"show",class:"content"},q={class:"word"},N={class:"word"},A={class:"word"},I={class:"word"},z={class:"word"},V={class:"word"},K={class:"word"};function D(e,t,n,o,s,c){const u=y,_=E;return d(),f(v,null,[s.guide?(d(),f("div",P,[i("div",C,[h(u,{type:"info"},{default:w(()=>[R]),_:1})]),i("div",M,[h(_,{class:"button",color:"#0a0eff",onClick:c.connect},{default:w(()=>[g("\u8FDE\u63A5\u8BBE\u5907")]),_:1},8,["onClick"]),h(_,{class:"button",color:"#0f5a6f",onClick:c.start},{default:w(()=>[g("\u5F00\u59CB\u91C7\u96C6")]),_:1},8,["onClick"])])])):p("",!0),s.show?(d(),f("div",T,[i("p",q,a(s.ctx[0]),1),i("p",N,a(s.ctx[1]),1),i("p",A,a(s.ctx[2]),1),i("p",I,a(s.ctx[3]),1),i("p",z,a(s.ctx[4]),1),i("p",V,a(s.ctx[5]),1),i("p",K,a(s.ctx[6]),1)])):p("",!0)],64)}const O=F(L,[["render",D],["__scopeId","data-v-8187efa8"]]);export{O as default};
